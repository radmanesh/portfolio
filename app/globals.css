/* file: globals.css */
@import 'tailwindcss';

@plugin 'tailwindcss-animate';

@custom-variant dark (&:is(.dark *));

@theme {
  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);
  --font-logo: var(--font-logo);
  --font-display: var(--font-display);

  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));

  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));

  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));

  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));

  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));

  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));

  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));

  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));

  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));

  --color-chart-1: hsl(var(--chart-1));
  --color-chart-2: hsl(var(--chart-2));
  --color-chart-3: hsl(var(--chart-3));
  --color-chart-4: hsl(var(--chart-4));
  --color-chart-5: hsl(var(--chart-5));

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);
}

/*
  The default border color has changed to `currentColor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentColor);
  }
}

@layer utilities {
  body {
    font-family: Arial, Helvetica, sans-serif;
  }
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 240 10% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 3.9%;
    --primary: 240 5.9% 10%;
    --primary-foreground: 0 0% 98%;
    --secondary: 240 4.8% 95.9%;
    --secondary-foreground: 240 5.9% 10%;
    --muted: 240 4.8% 95.9%;
    --muted-foreground: 240 3.8% 46.1%;
    --accent: 240 4.8% 95.9%;
    --accent-foreground: 240 5.9% 10%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;
    --ring: 240 10% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
  }
  .dark {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;
    --card: 240 10% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 240 5.9% 10%;
    --secondary: 240 3.7% 15.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 240 3.7% 15.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 240 4.9% 83.9%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    overflow-y: auto;              /* not 'scroll' */
    scrollbar-gutter: stable both-edges; /* keep layout stable without forcing overflow */
  }

  pre {
    @apply text-xs border border-border rounded-lg p-6 leading-normal overflow-x-auto whitespace-pre-wrap break-words w-full;
    min-width: 0;
  }

  .shiki {
    @apply w-full overflow-x-auto min-w-0;
  }

  .shiki code {
    @apply whitespace-pre-wrap break-words w-full;
  }

  /* Ensure pre elements inside shiki are properly contained */
  .shiki pre {
    @apply min-w-0;
  }

  p code {
    @apply text-xs border border-border bg-muted/80 rounded-md p-1;
  }

  .project-logo {
    @apply w-5 h-5 text-zinc-900 dark:text-zinc-100;
  }

  .prose {
    @apply space-y-6;
  }

  .prose table th {
    @apply text-xs md:text-sm p-2 text-left;
  }

  .prose table p,
  td {
    @apply text-xs md:text-sm;
  }

  .prose table td {
    @apply p-2;
  }

  .prose table thead {
    @apply border-b border-border;
  }

  .prose table tr {
    @apply border-b border-border;
  }

  .prose table tr:last-of-type {
    @apply border-none;
  }

  .prose ul {
    @apply list-disc px-6 text-muted-foreground;
  }

  .prose ul code {
    @apply text-xs md:text-sm border border-border bg-muted/80 rounded-md p-1;
  }

  .prose ol {
    @apply list-decimal px-6 text-muted-foreground;
  }

  .prose table + code {
    @apply text-xs border border-border bg-muted/80 rounded-md p-1;
  }
}

/* Gesture animations for Emotion Avatar */
@layer utilities {
  /* Performance hint for smoother animations */
  svg .avatar-head-anim, svg .eyes-group, svg .avatar-pupil { will-change: transform; }

  @keyframes avatar-nod {
  0%,100% { transform: translateY(0) rotate(0deg) scale(1); }
  20% { transform: translateY(5px) rotate(6deg) scale(1.005); }
  45% { transform: translateY(-3px) rotate(-3deg) scale(1.002); }
  70% { transform: translateY(2px) rotate(2deg) scale(1.003); }
  }
  @keyframes avatar-nod-joy {
    0%,100% { transform: translateY(0) rotate(0deg) scale(1); }
    22% { transform: translateY(6px) rotate(7deg) scale(1.01); }
    48% { transform: translateY(-3px) rotate(-3deg) scale(1.005); }
    72% { transform: translateY(2px) rotate(2deg) scale(1.006); }
  }
  @keyframes avatar-shake {
  0%,100% { transform: translateX(0); }
  15% { transform: translateX(-5px); }
  30% { transform: translateX(5px); }
  45% { transform: translateX(-4px); }
  60% { transform: translateX(4px); }
  75% { transform: translateX(-2px); }
  }
  @keyframes avatar-shake-soft {
    0%,100% { transform: translateX(0); }
    18% { transform: translateX(-3px); }
    36% { transform: translateX(3px); }
    54% { transform: translateX(-2px); }
    72% { transform: translateX(2px); }
  }
  @keyframes avatar-eyeroll {
    0% { transform: translate(0,0); }
    35% { transform: translate(6px,-2px); }
    55% { transform: translate(5px,-3px); }
    100% { transform: translate(0,0); }
  }
  @keyframes avatar-eyeswide {
    0% { transform: scale(1); }
    35% { transform: scale(1.1); }
    65% { transform: scale(1.16); }
    100% { transform: scale(1); }
  }
  @keyframes avatar-leanin {
    0% { transform: translateY(0) scale(1); }
    40% { transform: translateY(4px) scale(1.02); }
    100% { transform: translateY(0) scale(1); }
  }
  @keyframes avatar-tiltside-pulse {
    0%,100% { transform: rotate(-8deg); }
    50% { transform: rotate(-6deg); }
  }
  @keyframes avatar-tiltback-sway {
    0%,100% { transform: rotate(-4deg) translateY(0); }
    35% { transform: rotate(-5deg) translateY(-2px); }
    70% { transform: rotate(-3deg) translateY(1px); }
  }

  /* Scope animations to .gesture-* namespaces to avoid interfering globally */
  svg.gesture-nod .avatar-head-anim { animation: avatar-nod 720ms cubic-bezier(.22,.61,.36,1); transform-origin: center; transform-box: fill-box; }
  svg.gesture-shake .avatar-head-anim { animation: avatar-shake 620ms cubic-bezier(.22,.61,.36,1); transform-origin: center; transform-box: fill-box; }
  svg.gesture-leanIn .avatar-head-anim { animation: avatar-leanin 980ms cubic-bezier(.22,.61,.36,1); transform-origin: center; transform-box: fill-box; }
  svg.gesture-tiltSide .avatar-head-anim { animation: avatar-tiltside-pulse 1200ms ease-in-out; transform-origin: center; transform-box: fill-box; }
  svg.gesture-eyesWide .eyes-group { animation: avatar-eyeswide 850ms ease; transform-origin: center; transform-box: fill-box; }
  svg.gesture-eyeroll .avatar-pupil { animation: avatar-eyeroll 900ms ease; transform-origin: center; transform-box: fill-box; }

  /* Emotion-specific refinements */
  svg.emotion-happy.gesture-nod .avatar-head-anim,
  svg.emotion-excited.gesture-nod .avatar-head-anim { animation-name: avatar-nod-joy; animation-duration: 760ms; }
  svg.emotion-fearful.gesture-shake .avatar-head-anim { animation-name: avatar-shake-soft; animation-duration: 680ms; }
  svg.emotion-fearful.gesture-tiltBack .avatar-head-anim { animation: avatar-tiltback-sway 900ms ease-in-out; }
}
